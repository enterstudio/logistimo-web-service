/*
 * Copyright Â© 2017 Logistimo.
 *
 * This file is part of Logistimo.
 *
 * Logistimo software is a mobile & web platform for supply chain management and remote temperature monitoring in
 * low-resource settings, made available under the terms of the GNU Affero General Public License (AGPL).
 *
 * This program is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General
 * Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any
 * later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Affero General Public License
 * for more details.
 *
 * You should have received a copy of the GNU Affero General Public License along with this program.  If not, see
 * <http://www.gnu.org/licenses/>.
 *
 * You can be released from the requirements of the license by purchasing a commercial license. To know more about
 * the commercial license, please contact us at opensource@logistimo.com
 */

(function(n,t,i,r){i.defaultSettings({stringsMap:{c1tabTocLabel:"toc.label",c1tabIndexLabel:"index.label",c1tabSearchLabel:"search.label",c1headerText:"pageHeaderText"}});var u,o=["toc","index","search"],f={toc:0,index:1,search:2,0:0,1:1,2:2},e={};i.bind("writebody",function(){var s=t.designer,e=i.isTopicOnlyMode(),f,o;u=n("#c1page").parent(),u.length||(u=n("body")),e&&u.addClass("topic-only"),i.setting("general.rightToLeft")&&u.attr("dir","rtl").css("direction","rtl"),f=i.header={_header:n("#c1header"),_main:n("#c1main"),visible:function(n){var i=f._header;if(n==r)return i.is(":visible");n?e||(i.show(),f._main.css("top",i.height()+2)):(i.hide(),f._main.css("top",0))},height:function(n){var t=f._header;if(n==r)return f.visible()?t.height():0;n=+n,!n||n<0?f.visible(!1):e||(t.height(n).show(),f._main.css("top",t.height()+2))},logo:function(n){var i=f._header.find(".c1-header-logo");if(n==r)return i.is(":visible")?i.attr("src"):!1;n?(t.isString(n)&&i.attr("src",n),i.show()):i.hide()},text:function(n){var i=f._header.find(".c1-header-text");if(n==r)return i.text();n?(t.isString(n)&&i.text(n),i.show()):i.hide()},html:function(n){if(n==r)return f._header.html();f._header.html(n)}},f.logo(t.str(i.setting("pageHeader.logoImage"),"")),o=i.setting("pageHeader.visible"),o?(f.height(i.setting("pageHeader.height")),i.setting("pageHeader.showText",{types:"boolean"})===!1&&n("#c1headerText").hide()):f.visible(!1)}),i.plugin({name:"theme",create:function(){var nt=i.theme=i.theme||{},c,it=t.designer,a,y,p,h;if(i.setting("topic.applyStylesheet")!==!1&&n("#c1topicPanel").addClass("ui-widget-content"),i.isTopicOnlyMode())setTimeout(function(){u.addClass("topic-only")},100);else{var s=n("#c1sideTabs"),d=n("#c1sideTabsHeader"),l=n("#c1sideTabsPanel"),b=!!i.setting("theme.rememberActiveTab"),k="c1sideActiveTab",v=b&&n.cookie&&n.cookie(k)||f[((/(?:\?|&|^)tab=([^&]+)(?:&|$)/i.exec(location.search)||[])[1]||"0").toLowerCase()],tt=i.index;n.each(["index","search"],function(n,t){c=i.setting(t+".visible"),!n&&c&&(c=tt.hasKeywords()||!i.setting("index.hideEmpty")),c||(n=f[t],e[n]=!0,d.children().eq(n).add(l.children().eq(n)).hide())}),a=nt.recalcTabsTop=function(){l.css("top",t.px2em(l,d.outerHeight()+parseFloat(s.css("paddingTop"))+3))},s.show().tabs(),s.bind("tabsactivate",function(t,r){var f=s.tabs("option","active"),u;b&&n.cookie&&n.cookie(k,f||null,{expires:365}),u=n("input",r.newPanel),u.length||(u=n("a",r.newPanel).first()),u.focus(),i.trigger("tab",t,{index:f,tab:o[f],panel:r.newPanel,label:r.newTab})}),v&&!e[v]&&s.tabs("option","active",+v),i.switchTab=function(n){n=f[n],n!=r&&s.tabs("option","active",+n)};function w(){a()}s.is(":visible")?w():(y=100,p=setInterval(function(){(s.is(":visible")||!y--)&&(clearInterval(p),w())},100)),h=i.splitter=t.splitter("#c1splitter",t.splitter.settings2options(t.extend({rightSide:!!i.setting("general.rightToLeft"),side:"#c1side",main:"#c1content"},i.setting("splitter")))),h.bind("splitter",function(){a()}).bind("*",function(n,t){n=n.originalEvent,i.trigger(n.type,n,t)}),h.position(h.position());function g(){var t=n("#c1topic .topic-frame");t.length&&t.css("top",n("#c1topicBar").outerHeight()+2)}n(window).resize(g),i.bind("topicupdate breadcrumbsupdate",g)}}}),i.driver("themedesigner",function(){var r=t.designer;if(r){r.hooks["topic.spinner"]=function(t,r){i.topicSpin(r),n(".preview-popup").toggle(!r)},i.bind("tab",function(n,t){r.isDesigntime()&&r.select(t.panel)}),n.each(o,function(n,t){r.hooks[t]=function(n,r){r&&!e[f[t]]&&i.switchTab(t)}});var h=100,u=!1,s=!1;r.hooks.splitter=function(n,t){t?u||(h=r.selecter.css("z-index"),s=i.splitter.options.disabled&&!i.splitter.options.locked,i.splitter.enable(),u=!0,r.selecter.css("z-index",99)):(r.selecter.css("z-index",h),i.splitter[s?"disable":"lock"](),u=!1)},i.bind("splitter",function(n,t){u&&(r.trigger("setting",n,{role:"splitter",setting:"splitter.position",value:t.position}),collapsed=t.collapsed===!0?!0:!1,i.splitter.options.collapsed=collapsed,r.trigger("setting",n,{role:"splitter",setting:"splitter.collapsed",value:collapsed}),r.select(i.splitter.splitter))}).bind("splitterstart splitterstop",function(n){r.lock(n.type==="shellsplitterstart")})}})})(jQuery,nethelp,nethelpshell)